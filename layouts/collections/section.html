{{- define "main" -}}
<article class="content mx-auto px-8 xl:px-16 relative">
    {{partial "collection_sorter" .}}
    <section class="overflow-x-hidden content mx-auto">
        <div id="filter-loading" class="text-center font-semibold fixed inset-x-0 mt-24 text-4xl">
            <i class="fad fa-spinner-third fa-spin"></i>
        </div>
        <div id="filter-error" class="text-center text-xl font-semibold fixed inset-x-0 mt-24">
            <h1>NO RESULTS.</h1>
            <h2>TRY REMOVING SOME OF THE SELECTED CATEGORIES ABOVE.</h2>
        </div>
        <!-- {{ range (readDir "content/collections/") }}"/collections/{{ .Name }}", {{ end }} -->
        <section id="filter" class="flex flex-wrap overflow-hidden filter-container z-10" style="opacity: 0;">
            <!-- {{ range where (where .Pages.ByDate ".Params.collection_archive" "!=" true) ".Params.collection_hidden" "!=" true}}
                    {{ partial "collection_sorter_item" .}}
            {{ end }} -->
            {{ range .Site.Data.categories}}
            {{ range .collection_sorter}}
            {{ with $.Site.GetPage . }}
                {{ if eq .Params.collection_archive false }}
                {{ if eq .Params.collection_hidden false }}
                    {{ partial "collection_sorter_item" . }}
                {{ end }}
                {{ end }}
            {{ end }}
            {{ end }}
            {{ end }}
            <!-- <div class="filter-item w-screen filter-archive {{range $.Site.Data.categories.categories.categories}}{{. | replaceRE "[\\W]" "" | lower}} {{end}} personal commissionedstock all active" data-filter="{{range $.Site.Data.categories.categories.categories}}{{. | replaceRE "[\\W]" "" | lower}},{{end}},all,personal,commissionedstock"></div> -->
            <div class="filter-item w-screen filter-archive {{range $.Site.Data.categories.categories.categories}}{{. | replaceRE "[\\W]" "" | lower}} {{end}} personal commissionedstock all active"  data-filter="{{range $.Site.Data.categories.categories.categories}}{{. | replaceRE "[\\W]" ""| lower}},{{end}},all,personal,commissionedstock"><h1 class="p-2 text-lg font-bold">ARCHIVE</h1></div>
            <!-- {{ range where (where .Pages.ByDate ".Params.collection_archive" "=" true) ".Params.collection_hidden" "!=" true}}
                {{ partial "collection_sorter_item" .}}
            {{ end }} -->
            {{ range .Site.Data.categories}}
            {{ range .collection_sorter}}
            {{ with $.Site.GetPage . }}
                {{ if eq .Params.collection_archive true }}
                {{ if eq .Params.collection_hidden false }}
                    {{ partial "collection_sorter_item" . }}
                {{ end }}
                {{ end }}
            {{ end }}
            {{ end }}
            {{ end }}
        </section>
    </section>
</article>
{{- end -}}

{{- define "attached" -}}
{{ $filter := .Site.Data.webpack.filter }}
{{ with $filter.js }}
<script src="{{ . | relURL }}" async></script>
{{ end }}
{{- end -}}